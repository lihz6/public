(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{186:function(e,t,n){e.exports=n(404)},195:function(e,t,n){},336:function(e,t,n){},339:function(e,t,n){},348:function(e,t,n){},359:function(e,t,n){},360:function(e,t,n){},361:function(e,t,n){},362:function(e,t,n){},401:function(e,t,n){},402:function(e,t,n){},403:function(e,t,n){},404:function(e,t,n){"use strict";n.r(t);n(135);var r=n(54),a=(n(188),n(7)),c=n(0),i=n.n(c),o=n(10),u=n.n(o);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=n(183),s=(n(194),n(195),n(11)),d=n(94),f=n(95),m=n(101),h=n(96),p=n(63),b=n(102);var v,g,E=(v="https://pro.ngolin.com",function(e,t,n){return fetch(function(e,t){if(t.includes("//"))return t;switch([e.slice(-1),t.slice(0,1)].filter(function(e){return"/"===e}).length){case 2:return e+t.slice(1);case 1:return e+t;default:return e+"/"+t}}(v,function(e){return e.indexOf("?")>=0?e+"&ts=".concat(Date.now()):e+"?ts=".concat(Date.now())}(e)),function(e,t){var n={credentials:"include",method:"GET",mode:"cors"};return t&&(n.headers=t),e&&(n.method="POST",e instanceof FormData?n.body=e:(n.body=JSON.stringify(e),n.headers=Object(s.a)({"Content-Type":"application/json"},t))),n}(t,n)).then(function(e){if(e.ok)return e.json();throw e.statusText})});!function(e){e[e.LOADING=-1]="LOADING",e[e.UNKNOWN=0]="UNKNOWN"}(g||(g={}));var w={popupView:null,userflag:21,userName:"",username:"",avatar:""},O=Object(c.createContext)(w),y=O.Provider,j=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).state=Object(s.a)({setContextState:n.setState.bind(Object(p.a)(n))},w),n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this;E("/core/context").then(function(t){e.setState(t)}).catch(function(){e.setState({userflag:1})})}},{key:"render",value:function(){var e=this.props.children;return i.a.createElement(y,{value:this.state},e(this.state))}}]),t}(c.PureComponent),N=(n(196),n(170));function x(){return i.a.createElement(N.a,{spinning:!0,style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}})}n(73);var S=n(18),C=(n(212),n(184)),k=(n(405),n(69)),I=(n(143),n(76)),M=(n(144),n(12)),z=(n(218),n(106)),L=n(4);var P=k.a.create()(function(e){var t=e.form,n=t.getFieldDecorator,r=t.validateFields,a=Object(c.useState)(!1),o=Object(L.a)(a,2),u=o[0],l=o[1],s=Object(c.useContext)(O).setContextState;return Object(c.useEffect)(function(){document.title="\u8bf7\u767b\u5f55"},[]),i.a.createElement("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},i.a.createElement(k.a,{className:"-glob-box-shadow",onSubmit:function(e){e.preventDefault(),r(function(e,t){var n;e?console.error(e):(l(!0),(n=t,E("/x000/signin",n)).then(function(e){s(e),l(!1)}).catch(function(e){z.a.error(e),l(!1)}))})},style:{backgroundColor:"white",minWidth:"320px",padding:"48px 32px"}},i.a.createElement(k.a.Item,null,n("username",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7535\u5b50\u90ae\u7bb1"}]})(i.a.createElement(I.a,{name:"username",prefix:i.a.createElement(M.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"\u7535\u5b50\u90ae\u7bb1"}))),i.a.createElement(k.a.Item,null,n("password",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801\uff08\u4e0d\u5c11\u4e8e 8 \u4f4d\uff09",min:8}]})(i.a.createElement(I.a,{prefix:i.a.createElement(M.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",name:"password",placeholder:"\u5bc6\u7801"}))),i.a.createElement(k.a.Item,null,i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},n("remember",{valuePropName:"checked",initialValue:!0})(i.a.createElement(C.a,null,"\u8bb0\u4f4f\u767b\u5f55")),i.a.createElement("a",{className:"login-form-forgot",onClick:function(){r(["username"],function(e,t){e?console.error(e):function(e){var t=e.username;return E("/x000/forget-pword",{username:t}).then(function(){return"\u767b\u5f55\u5bc6\u7801\u5df2\u53d1\u9001\uff0c\u8bf7\u67e5\u6536\u4f60\u7684\u90ae\u7bb1"})}(t).then(function(e){z.a.success(e)}).catch(function(e){z.a.error(e)})})}},"\u5fd8\u8bb0\u5bc6\u7801")),i.a.createElement(S.a,{type:"primary",htmlType:"submit",loading:u,style:{width:"100%"}},"\u767b\u5f55"))))}),A=n(45);function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(r){var a=function(e,t,n){var r=Object.keys(t),a=Object.keys(n);if(r.length&&a.length)return function(c){var i=Object(s.a)({},t,n,c);return"".concat(e,"/").concat(r.map(function(e){return encodeURIComponent(i[e])}).join("/"),"?").concat(a.map(function(e){return"".concat(e,"=").concat(encodeURIComponent(i[e]))}).join("&"))};if(r.length)return function(n){var a=Object(s.a)({},t,{params:n});return"".concat(e,"/").concat(r.map(function(e){return encodeURIComponent(a[e])}).join("/"))};if(a.length)return function(t){var r=Object(s.a)({},n,t);return"".concat(e,"?").concat(a.map(function(e){return"".concat(e,"=").concat(encodeURIComponent(r[e]))}).join("&"))};return function(){return e}}(e,t,n),c=r;return Object.keys(t).length&&(c=function(e){return i.a.createElement(A.d,null,i.a.createElement(A.b,{path:a((c=t,Object.keys(c).reduce(function(e,t){return e[t]=":".concat(t),e},{}))).split("?")[0],render:function(t){return i.a.createElement(r,Object(s.a)({},e,t))}}),i.a.createElement(A.a,{to:a(Object(s.a)({},t,n))}));var c}),c.displayName="withPath(".concat(e,")"),c.pathOf=a,c.path=e,c}}var D=R("/x000/head",{})(function(e){e.history,e.match.params;return Object(c.useEffect)(function(){document.title="Title"},[]),i.a.createElement(r.a.Header,{className:"-glob-box-shadow",style:{height:"85px",display:"flex",padding:"0",backgroundColor:"white"}},"Header")}),F=(n(327),n(55)),T=n(64),X=n.n(T),W=n(65),B=n.n(W),G=n(53),H=n.n(G);function K(e,t){return H()(e,t).map(function(e){return'"'.concat(e.map(function(e){return"a".concat(e)}).join(" "),'"')}).join(" ")}function U(e,t){var n=e/(t||1),r=!1;return function(a){if(a<=0)return 0;if(0===(t-=a))return e;if(t>0){var c=function(e){return(r=!r)?Math.floor(e):Math.ceil(e)}(a*n);return e-=c,c}throw"No size to alloc anymore!"}}(function e(t){var n=t.getFullYear(),r=t.getMonth()+1,a=t.getDate(),c=t.getHours();return function(t,i,o){if(c>20&&e(new Date),t===n){if(i===r)switch(a-o){case 0:return"";case 1:return"\u6628\u5929";default:return"".concat(o,"\u65e5")}return"".concat(i,"\u6708").concat(o,"\u65e5")}return"".concat(t,"\u5e74").concat(i,"\u6708").concat(o,"\u65e5")}})(new Date);var q=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return[Math.floor(e/t)+n,e%t+n]},J=function(e){return V(e).join(" ")};function V(e){if(e&&!0!==e||0===e){if(Array.isArray(e))return e.map(V).reduce(function(e,t){return e.concat(t)},[]);var t=typeof e;if("string"===t||"number"===t)return[e];if("object"===t){var n=function(){var t=[],n=function(n){var r=e[n];(r||0===r)&&(t.push(n),V(r).forEach(function(e){t.push(n+"-"+e)}))};for(var r in e)n(r);return{v:t}}();if("object"===typeof n)return n.v}}return[]}n(162);var Y,$,Q=n(68),Z=(n(336),n(31));!function(e){e.MAIN="main",e.LOCK="lock",e.FLEX="flex",e.GRID="grid",e.AREA="area",e.PIPE="pipe",e.BONE="bone"}(Y||(Y={})),function(e){e.T2B="column",e.L2R="row"}($||($={}));var _={W5H5:{id:"W5H5",width:50,height:50,color:"gray"},W3H3:{id:"W3H3",width:30,height:30,color:"gray"}};function ee(e){var t=e.width,n=e.children,r=function e(t){return t.reduce(function(t,n){var r=n,a=r.children,c=r.pipe;return a&&a.length>0?Math.max(t,e(a)):c&&c.height>0?Math.max(t,c.height):t},0)}(n),a=(t-r)*(t+r),c=t-Math.sqrt(a);return Math.ceil(c*(n.length-1))}function te(e,t){var n=e,r=n.id,a=n.children,c=void 0===a?[]:a;if(r===t)return[e];var i=!0,o=!1,u=void 0;try{for(var l,s=c[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var d=te(l.value,t);if(d.length)return d.concat(e)}}catch(f){o=!0,u=f}finally{try{i||null==s.return||s.return()}finally{if(o)throw u}}return[]}function ne(e){return e.length>2&&e[1].type===Y.FLEX&&e[1].children.reduce(function(t,n){return t&&(n.type===Y.PIPE||n.id===e[0].id)},!0)?ne(e.slice(1)):e}function re(e,t){var n=t(e);if(n!==e)return n;if(!e.children)return e;var r=e.children.reduce(function(e,n){var r=Object(L.a)(e,2),a=r[0],c=r[1],i=re(n,t);return a.push(i),[a,c||n!==i]},[[],!1]),a=Object(L.a)(r,2),c=a[0];return a[1]?Object(s.a)({},e,{children:c}):e}function ae(e,t,n){return re(e,function(e){return e.id===t.id?n:e})}function ce(e,t){return re(e,function(e){if(e.type!==Y.FLEX||e.children.every(function(e){return e.id!==t}))return e;var n=e.children.findIndex(function(e){return e.id===t}),r=e.children.slice();switch(r[n].type===Y.PIPE?r.splice(n,1):r.splice(n&&n-1,2),r.length){case 1:return Object(s.a)({},r[0],{size:e.size,grow:e.grow});case 0:throw"Not Implemented";default:return Object(s.a)({},e,{children:r})}})}function ie(e,t){var n=Object(s.a)({},e,{id:t(e.id)});return e.children&&(n.children=e.children.map(function(e){return ie(e,t)})),n}function oe(e){var t=e.onSubmit,n=e.size,r=void 0===n?"default":n,a=e.width,o=e.height,u=e.title,l=void 0===u?"":u,s=e.position,d=void 0===s?"":s,f=e.flow,m=Object(c.useState)(l),h=Object(L.a)(m,2),p=h[0],b=h[1],v=Object(c.useState)(o),g=Object(L.a)(v,2),E=g[0],w=g[1],O=Object(c.useState)(a),y=Object(L.a)(O,2),j=y[0],N=y[1],x=Object(c.useState)(f),C=Object(L.a)(x,2),k=C[0],M=C[1],z=Object(c.useState)(d),P=Object(L.a)(z,2),A=P[0],R=P[1],D=!j||!E||!p||!A||p===l&&E===o&&j===a&&A===d&&k===f;return i.a.createElement("div",{className:"draw-base-main"},i.a.createElement("div",{className:J({"draw-base-item":r})},i.a.createElement("div",null,"\u540d\u79f0\uff1a"),i.a.createElement(I.a,{placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0",autoFocus:"small"!==r,onChange:function(e){var t=e.target.value;return b(t)},value:p,size:r})),i.a.createElement("div",{className:J({"draw-base-item":r})},i.a.createElement("div",null,"\u3000\u5bbd\uff1a"),i.a.createElement(Q.a,{onChange:function(e){return N(e)},placeholder:"\u5355\u4f4d\uff1a\u6beb\u7c73(mm)",value:j,size:r,step:10,min:0}),i.a.createElement("div",null,"\u3000\u9ad8\uff1a"),i.a.createElement(Q.a,{onChange:function(e){return w(e)},placeholder:"\u5355\u4f4d\uff1a\u6beb\u7c73(mm)",value:E,size:r,step:10,min:0})),i.a.createElement("div",{className:J({"draw-base-item":r})},i.a.createElement("div",null,"\u5f00\u53e3\uff1a"),i.a.createElement(ue,{size:r,position:A,mainFlow:k,onSelect:function(e,t){M(e),R(t)}})),i.a.createElement("div",{className:J({"draw-base-item":r})},i.a.createElement("div",null,"\u3000\u3000\u3000"),i.a.createElement(S.a,{onClick:function(){t({width:j,height:E,title:p,flow:k,position:A})},size:r,type:"primary",disabled:D},"\u786e\u5b9a")))}function ue(e){var t=e.size,n=e.position,r=e.mainFlow,a=e.onSelect,c=[$.L2R,$.T2B],o=["10","01","010"];return i.a.createElement("div",{className:"draw-base-open",title:"\u8bf7\u9009\u62e9\u5f00\u53e3\u4f4d\u7f6e"},i.a.createElement("div",{onClick:function(){return a(r||$.L2R,"0")},className:J({"draw-base-box":[t,{enabled:"0"===n}]})}),c.map(function(e){return i.a.createElement(i.a.Fragment,{key:e},o.map(function(c){return i.a.createElement("div",{key:c,onClick:function(){return a(e,c)},className:J({"draw-base-box":[t,{enabled:e===r&&c===n}]}),style:{flexDirection:e}},c.split("").map(function(e){return i.a.createElement("div",{key:e,className:"draw-base-box-".concat(e)})}))}))}))}n(406);var le=n(182);n(339);function se(e){var t=e.setMinScale,n=e.setMaxScale,r=e.setScale,a=e.minScale,c=e.maxScale,o=e.scale;return i.a.createElement("div",{className:"draw-scale-main"},i.a.createElement(M.a,{type:"minus-circle",className:"draw-scale-min",onClick:t}),i.a.createElement(le.a,{className:"draw-scale-slider",min:a,max:c,tipFormatter:function(e){return"".concat(e,"%")},onChange:function(e){return r(e)},value:o}),i.a.createElement(M.a,{type:"plus-circle",className:"draw-scale-max",onClick:n}))}n(348);function de(e){var t=e.mainNode,n=Object(L.a)(e.offset,2),r=n[0],a=n[1],c=e.scale,o=e.focusId,u=e.onClick;return i.a.createElement("div",{className:J({"draw-node":t.type}),style:{transform:"translate(".concat(r,"px, ").concat(a,"px) scale(").concat(c/100,")"),width:"".concat(t.width,"px"),height:"".concat(t.height,"px"),flexDirection:t.flow,border:"".concat(100/c,"px solid #eee")}},t.children.map(function(e){return function e(t,n,r,a){var c={key:t.id,className:J({"draw-node":Object(Z.a)({focus:t.id===r},t.type,!0)})};var o=function(e){e.stopPropagation(),a(t)};switch(t.type){case Y.LOCK:return i.a.createElement("div",Object.assign({},c,{style:{flex:"0 0 ".concat(ee(n),"px"),background:"yellow"}}));case Y.GRID:return i.a.createElement("div",Object.assign({},c,{style:Object(s.a)({display:"grid",flex:"".concat(t.grow," ").concat(t.grow," ").concat(t.size,"px"),gridTemplateAreas:K(t.area,t.column)},(l=t.template,d=t.column,{gridTemplateRows:l.slice(d).map(function(e,t){return"".concat(e,t%2?"px":"fr")}).join(" "),gridTemplateColumns:l.slice(0,d).map(function(e,t){return"".concat(e,t%2?"px":"fr")}).join(" ")}))}),t.children.map(function(n){return e(n,t,r,a)}));case Y.FLEX:return i.a.createElement("div",Object.assign({},c,{onClick:o,style:{display:"flex",flexDirection:t.flow,flex:"".concat(t.grow," ").concat(t.grow," ").concat(t.size,"px")}}),t.children.map(function(n){return e(n,t,r,a)}));case Y.AREA:return i.a.createElement("div",Object.assign({},c,{onClick:o,style:{flex:"".concat(t.grow," ").concat(t.grow," ").concat(t.size,"px")}}));case Y.PIPE:var u=Math.ceil(t.pipe.width/10);return i.a.createElement("div",Object.assign({},c,{onClick:o,style:{flex:"0 0 ".concat(t.pipe.width,"px"),background:"#777",boxShadow:"inset ".concat(u,"px 0 ").concat(u,"px #aaa")}}));case Y.BONE:return i.a.createElement("div",Object.assign({},c,{onClick:o,style:{width:"".concat(t.bone.width,"px"),height:"".concat(t.bone.height,"px"),backgroundImage:"url(".concat(t.bone.url,")")}}))}var l,d}(e,t,o,u)}))}var fe=n(78),me=n(105),he=n.n(me);n(359);function pe(e){var t=e.setArea,n=e.startrc,r=e.endrc,a=e.area,o=e.children,u=Object(c.useState)(-1),l=Object(L.a)(u,2),s=l[0],d=l[1],f=r[1]-n[1];return Object(c.useEffect)(function(){var e=function(){d(-1)};return document.addEventListener("mouseup",e),function(){document.removeEventListener("mouseup",e)}},[]),i.a.createElement("div",{className:"draw-grid-sub-main",style:{gridColumnStart:n[1]+1,gridRowStart:n[0]+1,gridColumnEnd:r[1]+1,gridRowEnd:r[0]+1,gridTemplateAreas:K(a,f)}},a.filter(function(e,t){return e===t}).map(function(e){return i.a.createElement("div",{key:e,className:"draw-grid-sub-item",style:{gridArea:"a".concat(e)},onMouseEnter:function(){s>-1&&a.every(function(t,n){return t===n||t!==e})&&t(function(t){return{area:t.area.map(function(t,n){return function(e,t,n,r){var a=Math.min(t,n),c=Math.max(t,n);return e>=a&&e<=c&&e%r>=a%r&&e%r<=c%r}(n,s,e,f)?s:t})}})},onMouseDown:function(){a.every(function(t,n){return t===n||t!==e})&&d(e)},onDoubleClick:function(){t(function(t){return{area:t.area.map(function(t,n){return t===e?n:t})}})}})}),o)}n(360);var be=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).onMouseUp=function(){n.state.ondown&&n.setState(function(e){var t=e.start,r=e.end;if(!e.ondown)return null;var a=n.props.squared,c=q(r,a),i=q(t,a),o=he()(c,i).map(function(e){var t=Object(L.a)(e,2);return t[0]-t[1]+1}),u=Object(L.a)(o,2),l=u[0],s=u[1];return{area:Array.from({length:l*s}).map(function(e,t){return t}),ondown:!1}})},n.onMouseEnter=function(e){var t=n.props.squared,r=n.state,a=r.start;r.ondown&&he()(q(e,t),q(a,t)).every(function(e){var t=Object(L.a)(e,2);return t[0]>=t[1]})&&n.setState({end:e})},n.onMouseDown=function(e){n.props.disabled||n.setState({ondown:!0,start:e,end:e})},n.setState=n.setState.bind(Object(p.a)(n)),n.state={ondown:!1,start:-1,end:-1,area:[]},n}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mouseup",this.onMouseUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mouseup",this.onMouseUp)}},{key:"children",value:function(){var e=this,t=this.props,n=t.squared,r=t.disabled,a=t.onDone,c=this.state,o=c.start,u=c.end,l=c.ondown,s=c.area;if(r||o<0||u<0||l)return[null,Array.from({length:n*n}).map(function(e,t){return t})];var d=q(u,n,1),f=q(o,n),m=he()(d,f).map(function(e){var t=Object(L.a)(e,2);return t[0]-t[1]}),h=Object(L.a)(m,2),p=h[0],b=h[1];return[i.a.createElement(pe,{setArea:this.setState,startrc:f,endrc:d,area:s},i.a.createElement("div",{title:"\u79fb\u52a8",className:"draw-grid-move",onMouseDown:function(){e.setState({ondown:!0})}}),i.a.createElement("div",{title:"\u5b8c\u6210",className:"draw-grid-okay",onMouseDown:function(){a(b,s)}})),Array.from({length:n*n-p*b}).map(function(e,t){if(t<o)return t;var r=Math.floor((t-o)/(n-b));return t+Math.min(r+1,p)*b})]}},{key:"isSelected",value:function(e){var t=this.state,n=t.start,r=t.end,a=this.props.squared;return e>=n&&e<=r&&e%a>=n%a&&e%a<=r%a}},{key:"render",value:function(){var e=this,t=this.props,n=t.squared,r=t.disabled,a=this.children(),c=Object(L.a)(a,2),o=c[0],u=c[1];return i.a.createElement("div",{className:J({"draw-grid-main":{disabled:r}}),style:{gridTemplateColumns:"repeat(".concat(n,", 1fr)"),gridTemplateRows:"repeat(".concat(n,", 1fr)")}},o,u.map(function(t){return i.a.createElement("div",{key:t+1,className:J({"draw-grid-item":{selected:e.isSelected(t)}}),onMouseEnter:function(){return e.onMouseEnter(t)},onMouseDown:function(){return e.onMouseDown(t)}})}))}}]),t}(i.a.PureComponent);var ve=n(39);function ge(e,t,n){var r=Object(L.a)(t,2),a=r[0],c=r[1],i=c&&a.type===Y.AREA;return[!i,function(t,r){if(i&&t&&t<=r.length&&t*r.length>1&&r.length%t===0){var c=function(e,t,n,r,a){if(1===n||n===r.length){var c=function(e,t,n,r){return Object(s.a)({},e,{type:Y.FLEX,flow:1===t?$.T2B:$.L2R,children:n.reduce(function(e,t){return e.length&&e[e.length-1][0]===t?e[e.length-1].push(t):e.push([t]),e},[]).map(function(e){return e.length}).reduce(function(e,t,n){return 0!==n&&e.push({id:r(),type:Y.PIPE,pipe:_.W5H5}),e.push({id:r(),type:Y.AREA,size:0,grow:t}),e},[])})}(e,n,r,a);return[e,c]}return[e,Ee(e,n,r,a)]}(a,0,t,r,n),o=Object(L.a)(c,2),u=o[0],l=o[1];e(function(e){return ae(e,u,l)})}}]}function Ee(e,t,n,r){var a=H()(n.reduce(function(e,t){var n=Object(L.a)(e,2),r=n[0],a=n[1],c=a.findIndex(function(e){return e===t});return c>-1?r.push(c):r.push(a.push(t)-1),[r,a]},[[],[]])[0],t);return Object(s.a)({},e,{type:Y.GRID,column:2*t,template:Array.from({length:2*(t+a.length)}).map(function(e,t){return(t+1)%2}),area:a.reduce(function(e,t){var n=t.reduce(function(e,t){return[].concat(Object(ve.a)(e),[t,t])},[]);return[].concat(Object(ve.a)(e),Object(ve.a)(n),Object(ve.a)(n))},[]),children:n.filter(function(e,t){return e===t}).map(function(){return{id:r(),type:Y.AREA,grow:0,size:0}})})}function we(e,t,n,r){var a=t[1]&&t[1].type!==Y.FLEX;return[!a,function(t,c){if(a){if(c)return e(function(e){return ce(e,c.id)});var i=function(e,t,n){var r=t,a=Object(L.a)(r,2),c=a[0],i=a[1],o={top:$.T2B,bottom:$.T2B}[e]||$.L2R,u=function(t){var r={id:n(),type:Y.PIPE,pipe:_.W5H5};return["top","left"].includes(e)?[r].concat(Object(ve.a)(t)):[].concat(Object(ve.a)(t),[r])};if(i.type===Y.FLEX&&i.flow===o){var l=Object(s.a)({},i,{children:u(i.children)});return[i,l]}var d={id:n(),type:Y.FLEX,size:c.size||0,grow:c.grow||1,flow:o,children:u([Object(s.a)({},c,{size:0,grow:1})])};return[c,d]}(t,n,r),o=Object(L.a)(i,2),u=o[0],l=o[1];e(function(e){return ae(e,u,l)})}}]}n(361);var Oe=["top","right","bottom","left"];function ye(e){var t=e.setMainNode,n=e.newNodeId,r=e.focusNode,a=e.innerNode,c=Object(fe.a)(e,["setMainNode","newNodeId","focusNode","innerNode"]),o=ge(t,a,n),u=Object(L.a)(o,2),l=u[0],s=u[1],d=function(e,t){if(e.length>=t.length)return{};var n=function(e,t){return e===$.T2B?t?"bottom":"top":t?"right":"left"};return t.slice(0,1-e.length).reduce(function(e,t){if(t.type===Y.FLEX){var r=t.flow,a=t.children;a[0].type===Y.PIPE&&(e[n(r,0)]=a[0]),a.slice(-1)[0].type===Y.PIPE&&(e[n(r,-1)]=a.slice(-1)[0])}return e},{})}(r,a),f=we(t,r,a,n),m=Object(L.a)(f,2),h=m[0],p=m[1];return i.a.createElement("div",{className:J({"draw-grid-box-main":{borderless:h}})},Oe.map(function(e){return i.a.createElement("div",{key:e,className:J({"draw-grid-box-border":{enabled:!!d[e]}}),style:{gridArea:e},onClick:function(){return p(e,d[e])}})}),i.a.createElement(be,Object.assign({},c,{onDone:s,disabled:l})))}function je(e,t,n){var r=Object(L.a)(t,2),a=r[0],c=r[1],i=c&&c.type===Y.FLEX&&a.type!==Y.PIPE;return[!i,function(){i&&e(function(e){return function(e,t,n){return re(e,function(e){if(e.type!==Y.FLEX||e.children.every(function(e){var n=e.id;return n!==t}))return e;var r=e.children.findIndex(function(e){var n=e.id;return n===t}),a=e.children.slice(),c=r&&r-1,i=a.slice(c,c+2).map(function(e){return ie(e,n)});return a.splice.apply(a,[c,0].concat(Object(ve.a)(i))),Object(s.a)({},e,{children:a})})}(e,a.id,n)})}]}function Ne(e,t){var n=Object(L.a)(t,1)[0],r=n&&[Y.FLEX,Y.GRID,Y.BONE].includes(n.type);return r&&n.type===Y.BONE?[!r,function(){throw"Not implemented"}]:[!r,function(){r&&e(function(e){return function(e,t){return re(e,function(e){return e.id!==t?e:{id:e.id,type:Y.AREA,size:e.size,grow:e.grow}})}(e,n.id)})}]}n(362);function xe(e){var t=e.setMainNode,n=e.focusNode,r=e.innerNode,a=je(t,n,e.newNodeId),c=Object(L.a)(a,2),o=c[0],u=c[1],l=function(e,t){var n=Object(L.a)(t,2),r=n[0],a=n[1],c=a&&a.type===Y.FLEX&&r.type!==Y.PIPE&&r.type!==Y.BONE&&a.children.filter(function(e){return e.grow&&e.id!==r.id}).length;return[!c,function(){c&&e(function(e){return ce(e,r.id)})}]}(t,n),s=Object(L.a)(l,2),d=s[0],f=s[1],m=Ne(t,r),h=Object(L.a)(m,2),p=h[0],b=h[1];return i.a.createElement("div",{className:"draw-menu-main"},i.a.createElement(S.a.Group,{size:"small",style:{display:"flex"}},i.a.createElement(S.a,{type:"default",disabled:o,onClick:u},"\u91cd\u590d"),i.a.createElement(S.a,{type:"default",disabled:p,onClick:b},"\u6e05\u7a7a"),i.a.createElement(S.a,{type:"default",disabled:d,onClick:f},"\u5220\u9664"),i.a.createElement(S.a,{type:"default"},"\u5168\u5c4f"),i.a.createElement(S.a,{type:"primary"},"\u89c6\u89d2")))}var Se=n(180),Ce=n.n(Se);n(401);function ke(e){var t=Object(L.a)(e.focusNode,2),n=t[0],r=t[1],a=e.onSubmit,o=Object(c.useState)({size:n.size,grow:n.grow}),u=Object(L.a)(o,2),l=u[0],s=l.size,d=l.grow,f=u[1],m=Object(c.useState)(r.template||[]),h=Object(L.a)(m,2),p=h[0],b=h[1],v=function(e,t){b(p.map(function(n,r){return r===t?e:n}))};if(r.type===Y.FLEX||r.type===Y.MAIN){var g,E=(g={},Object(Z.a)(g,$.L2R,"\u5bbd\uff1a"),Object(Z.a)(g,$.T2B,"\u9ad8\uff1a"),g);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Ie,{label:E[r.flow],onGrowChange:function(e){return f({grow:e,size:s})},onSizeChange:function(e){return f({grow:d,size:e})},base:r.children.reduce(function(e,t){return t.id===n.id?e:e+(t.grow||0)},d),size:s,grow:d}),i.a.createElement("div",{className:"draw-size-item"},i.a.createElement("div",null,"\u3000\u3000"),i.a.createElement(S.a,{onClick:function(){a(n,{grow:d,size:s})},size:"small",type:"primary",disabled:s<0||d<0||s+d<=0||s===n.size&&d===n.grow},"\u786e\u5b9a")))}var w=r.column,O=r.area,y=r.children.findIndex(function(e){return e.id===n.id}),j=q(B()(O,y),w),N=Object(L.a)(j,2),x=N[0],C=N[1],k=q(X()(O,y),w,1),I=Object(L.a)(k,2),M=I[0],z=I[1],P=p.map(function(e,t){return[e,t]}),A=p.slice(0,w).map(function(e,t){return(t+1)%2&&e}).reduce(function(e,t){return e+t},0),R=p.slice(w).map(function(e,t){return(t+1)%2&&e}).reduce(function(e,t){return e+t},0);return i.a.createElement(i.a.Fragment,null,H()(P.slice(C,z),2).map(function(e){var t=Object(L.a)(e,2),n=Object(L.a)(t[0],2),r=n[0],a=n[1],c=Object(L.a)(t[1],2),o=c[0],u=c[1];return o<0?null:i.a.createElement(Ie,{key:a,onGrowChange:function(e){return v(e,a)},onSizeChange:function(e){return v(e,u)},label:"\u5bbd\uff1a",base:A,size:o,grow:r})}),H()(P.slice(w+x,w+M),2).map(function(e){var t=Object(L.a)(e,2),n=Object(L.a)(t[0],2),r=n[0],a=n[1],c=Object(L.a)(t[1],2),o=c[0],u=c[1];return o<0?null:i.a.createElement(Ie,{key:a,onGrowChange:function(e){return v(e,a)},onSizeChange:function(e){return v(e,u)},label:"\u9ad8\uff1a",base:R,size:o,grow:r})}),i.a.createElement("div",{className:"draw-size-item"},i.a.createElement("div",null,"\u3000\u3000"),i.a.createElement(S.a,{onClick:function(){a(r,{template:p})},size:"small",type:"primary",disabled:Ce()(r.template,p)},"\u786e\u5b9a")))}function Ie(e){var t=e.label,n=e.size,r=e.grow,a=e.base,c=e.onSizeChange,o=e.onGrowChange,u="".concat(a||1);return i.a.createElement("div",{className:"draw-size-item"},i.a.createElement("div",null,t),i.a.createElement(Q.a,{value:r,size:"small",disabled:a<=r,onChange:function(e){o(e||0)}}),i.a.createElement("div",{title:u},"\xa0/\xa0",u,"\xa0+\xa0"),i.a.createElement(Q.a,{size:"small",value:n,onChange:function(e){c(e||0)}}),i.a.createElement("div",null,"\xa0mm"))}function Me(e){var t=Object(c.useRef)(Date.now()),n=Object(c.useState)(function(e,t){var n=e.position,r=Object(fe.a)(e,["position"]);return Object(s.a)({},r,{version:1,id:t.current--,type:Y.MAIN,children:ze([{id:t.current--,type:Y.LOCK},{id:t.current--,type:Y.FLEX,flow:$.L2R,size:0,grow:1,children:[{id:t.current--,type:Y.PIPE,pipe:_.W5H5},{id:t.current--,type:Y.FLEX,flow:$.T2B,size:0,grow:1,children:[{id:t.current--,type:Y.PIPE,pipe:_.W5H5},{id:t.current--,type:Y.AREA,size:0,grow:1},{id:t.current--,type:Y.PIPE,pipe:_.W5H5}]},{id:t.current--,type:Y.PIPE,pipe:_.W5H5}]}],"10",n,t)})}(e,t)),r=Object(L.a)(n,2),a=r[0],i=r[1],o=Object(c.useMemo)(function(){return function(e){var t=Object(Z.a)({},e.id,{width:e.width,height:e.height});return function e(n,r){if(n.type===Y.GRID){var a=function(e,t){var n=t.reduce(function(e,t,n){var r=Object(L.a)(e,2),a=r[0],c=r[1];return n%2?[a,c+Math.abs(t)]:[a+t,c]},[0,0]),r=Object(L.a)(n,2),a=r[0],c=U(e-r[1],a);return t.map(function(e,t){return t%2?Math.abs(e):c(e)})},c=n.column,i=n.template,o=n.area,u=n.children,l=a(t[n.id].width,i.slice(0,c)),s=a(t[n.id].height,i.slice(c));u.forEach(function(n,r){var a=B()(o,r),i=X()(o,r),u=q(a,c),d=Object(L.a)(u,2),f=d[0],m=d[1],h=q(i,c,1),p=Object(L.a)(h,2),b=p[0],v=p[1];t[n.id]={width:l.slice(m,v).reduce(function(e,t){return e+t},0),height:s.slice(f,b).reduce(function(e,t){return e+t},0)},n.type!==Y.FLEX&&n.type!==Y.GRID||e(n,n.children)})}else{var d,f=function(e,n){var r=e.id;return e.flow===$.L2R?{width:n,height:t[r].height}:{width:t[r].width,height:n}},m=r.reduce(function(e,r){var a=Object(L.a)(e,3),c=a[0],i=a[1],o=a[2];if(r.type===Y.LOCK){var u=ee(n);return t[r.id]=f(n,u),[c+u,i,o]}if(r.type===Y.PIPE){var l=r.pipe.width;return t[r.id]=f(n,l),[c+l,i,o]}if(r.type===Y.MAIN)throw"Only one '".concat(Y.MAIN,"' one tree");var s=r.grow,d=r.size;return[c+Math.abs(d),i+s,o.concat(r)]},[0,0,[]]),h=Object(L.a)(m,3),p=h[0],b=h[1],v=h[2],g=U(t[n.id][(d={},Object(Z.a)(d,$.L2R,"width"),Object(Z.a)(d,$.T2B,"height"),d)[n.flow]]-p,b);v.forEach(function(r){var a=r.size,c=r.grow;t[r.id]=f(n,Math.abs(a)+g(c)),r.type!==Y.AREA&&r.type!==Y.BONE&&e(r,r.children)})}}(e,e.children),t}(a)},[a]);return{setMainNodeData:function(e){var n=e.position,r=Object(fe.a)(e,["position"]),c=a.children,o=c.map(function(e){var t=e.type;return Number(t===Y.PIPE)}).join("");i(o===n?Object(s.a)({},a,r):Object(s.a)({},a,r,{children:ze(c,o,n,t)}))},setMainNode:i,nodeSizing:o,resizeNode:function(e,t){var n=Object(s.a)({},e,t);i(ae(a,e,n))},newNodeId:function(){return t.current--},mainNode:a}}function ze(e,t,n,r){if(t===n)return e;var a={0:e.find(function(e){return e.type!==Y.LOCK}),1:e.find(function(e){return e.type===Y.LOCK})};return n.split("").map(function(e,t){var c=a[e]||{id:r.current--,type:Y.LOCK};return n.slice(0,t).includes(e)?ie(c,function(){return r.current--}):c})}var Le=function(e,t){var n=Object(c.useRef)({width:e.width,height:e.height}),r=Object(c.useState)(.618),a=Object(L.a)(r,2),i=a[0],o=a[1],u=Object(c.useState)(0),l=Object(L.a)(u,2),s=l[0],d=l[1],f=Object(c.useState)(1),m=Object(L.a)(f,2),h=m[0],p=m[1],b=Object(c.useState)([0,0]),v=Object(L.a)(b,2),g=v[0],E=v[1],w=function(e){var t=e.offsetHeight,r=e.offsetWidth,a=t/n.current.height*96,c=r/n.current.width*96,i=Math.ceil(Math.min(a,c)),u=Math.floor(Math.max(a,c));return d(i),p(u),o(i),E([(r-n.current.width)/2,0]),[i,u]},O=function(e){t.current&&(o(e),t.current.scrollTo({top:(n.current.height-t.current.offsetHeight)/2}))},y=function(){if(t.current){var e=t.current,r=w(e),a=Object(L.a)(r,2),c=a[0],i=a[1];d(c),p(i),o(function(t){return t<c?(e.scrollTo({top:(n.current.height-e.offsetHeight)/2}),c):t>i?(e.scrollTo({top:0}),i):t})}};return Object(c.useEffect)(function(){var t=e.width,r=e.height;n.current.width===t&&n.current.height===r||(n.current.height=r,n.current.width=t,y())},[e]),Object(c.useEffect)(function(){if(t.current){var e=t.current,n=w(e),r=Object(L.a)(n,1)[0];if(O(r),ResizeObserver){var a=new ResizeObserver(y);return a.observe(e),function(){return a.unobserve(e)}}return window.addEventListener("resize",y),function(){return window.removeEventListener("resize",y)}}},[t.current]),{offset:g,minScale:s,maxScale:h,scale:i,setScale:o,setMinScale:function(){O(s)},setMaxScale:function(){O(h)}}},Pe=n(181);function Ae(e){var t=Object(c.useState)({focusNode:[],innerNode:[]}),n=Object(L.a)(t,2),r=n[0],a=r.focusNode,i=r.innerNode,o=n[1],u=function(t,n){if(!t)return{focusNode:[],innerNode:[]};if(t.type===Y.PIPE){var r=te(e,t.id);return{focusNode:r,innerNode:r}}var a=te(e,n.length&&n[0].id),c=Object(Pe.a)(a),i=c[0],o=c.slice(1);if(o.length>1&&function e(t,n){var r=t,a=r.id,c=r.children;return a===n||(void 0===c?[]:c).some(function(t){return e(t,n)})}(i,t.id))return{focusNode:ne(o),innerNode:o};var u=te(e,t.id);return{focusNode:ne(u),innerNode:u}};return Object(c.useEffect)(function(){o(function(e){var t=e.focusNode,n=e.innerNode;return n.length?u(n[0],[]):{focusNode:t,innerNode:n}})},[e]),{focusNode:a,setFocusNode:function(e){o(u(e,a))},innerNode:i}}n(402);var Re=R("/x000/draw",{},{})(function(e){e.history,e.match.params;var t=Object(c.useContext)(O).username,n=Object(c.useState)(null),r=Object(L.a)(n,2),a=r[0],o=r[1];return a?i.a.createElement(De,Object.assign({author:t},a)):i.a.createElement("div",{className:"draw-init"},i.a.createElement(oe,{onSubmit:function(e){return o(e)}}))});function De(e){var t=Object(c.useRef)(null),n=Me(e),r=n.setMainNodeData,a=n.setMainNode,o=n.resizeNode,u=n.nodeSizing,l=n.newNodeId,s=n.mainNode;Object(c.useEffect)(function(){console.log(s)},[s]);var d=Ae(s),f=d.focusNode,m=d.innerNode,h=d.setFocusNode,p=Le(s,t),b=p.setMinScale,v=p.setMaxScale,g=p.setScale,E=p.minScale,w=p.maxScale,O=p.offset,y=p.scale,j=f.length&&f[0].id,N=m.length&&m[0].id;return i.a.createElement("div",{className:"draw-main"},i.a.createElement("div",{className:"draw-canvas",ref:t,tabIndex:0},i.a.createElement(de,{onClick:h,focusId:N,offset:O,scale:y,mainNode:s})),i.a.createElement("div",{className:"draw-object"},i.a.createElement(se,{setMinScale:b,setMaxScale:v,setScale:g,minScale:E,maxScale:w,scale:y}),i.a.createElement(xe,{setMainNode:a,focusNode:f,innerNode:m,newNodeId:l}),i.a.createElement(ye,{key:N,setMainNode:a,focusNode:f,innerNode:m,newNodeId:l,squared:9}),i.a.createElement(F.a,{defaultActiveKey:["2","3","4"]},i.a.createElement(F.a.Panel,{header:"\u6846\u4f53\u8bbe\u7f6e",key:"1"},i.a.createElement(oe,Object.assign({},s,{size:"small",key:j,onSubmit:function(e){return r(e)},position:s.children.map(function(e){var t=e.type;return Number(t===Y.LOCK)}).join("")}))),f[1]&&[Y.AREA,Y.FLEX,Y.GRID].includes(f[0].type)&&i.a.createElement(F.a.Panel,{header:"\u5c3a\u5bf8\u8bbe\u7f6e",key:"2"},i.a.createElement(ke,{key:j,focusNode:f,onSubmit:function(e,t){o(e,t)}})),function(e){var t=Object(L.a)(e,3),n=t[0],r=t[1],a=t[2];if(!r||n.type!==Y.AREA)return!1;if(r.type===Y.FLEX){var c=function(e,t){return e.children.filter(function(e){return e.grow&&e.id!==t.id}).length>0};return a&&a.type===Y.FLEX&&c(r,n)&&c(a,r)}if(r.type===Y.GRID){var i=r.column,o=r.area,u=r.children,l=r.template,s=u.findIndex(function(e){var t=e.id;return t===n.id}),d=q(B()(o,s),i),f=Object(L.a)(d,2),m=f[0],h=f[1],p=q(X()(o,s),i,1),b=Object(L.a)(p,2),v=b[0],g=b[1];if(v-m!==2||g-h!==2)return!1;var E=l.slice(0,i).map(function(e,t){return(t+1)%2&&e}).reduce(function(e,t){return e+t},0)-l[h],w=l.slice(i).map(function(e,t){return(t+1)%2&&e}).reduce(function(e,t){return e+t},0)-l[i+m];return E>0&&w>0}return!1}(f)&&i.a.createElement(F.a.Panel,{header:"\u82b1\u7eb9\u9009\u62e9",key:"3"},"\u82b1\u7eb9\u9009\u62e9"),m.length>0&&u[N]&&i.a.createElement(F.a.Panel,{header:"\u5c3a\u5bf8\u4fe1\u606f",key:"4"},"\u5bbd\uff1a",u[N].width,i.a.createElement("br",null),"\u9ad8\uff1a",u[N].height),i.a.createElement(F.a.Panel,{header:"\u51fa\u6599\u6e05\u5355",key:"5"},"\u51fa\u6599\u6e05\u5355"))))}var Fe=n(131);n(403);u.a.render(i.a.createElement(a.b,{locale:l.a},i.a.createElement(j,null,function(e){var t=e.userflag;e.userName,e.popupView;switch(t){case g.LOADING:return i.a.createElement(x,null);case g.UNKNOWN:return i.a.createElement(P,null);default:return i.a.createElement(Fe.a,{basename:"/public/windoors"},i.a.createElement(r.a,{style:{height:"100%"}},i.a.createElement(A.b,{component:D}),i.a.createElement(r.a,null,i.a.createElement(r.a.Sider,{width:200,theme:"light",style:{backgroundColor:"white"}},"Menu"),i.a.createElement(r.a,{style:{padding:"8px"}},i.a.createElement(A.d,null,i.a.createElement(A.b,{path:Re.path,component:Re}),i.a.createElement(A.a,{exact:!0,from:"/",to:"/x000/draw"}))))))}})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[186,1,2]]]);
//# sourceMappingURL=main.7b3e8938.chunk.js.map